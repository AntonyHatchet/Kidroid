//
   Created by anton_gorshenin on 24.04.2015.
extends layout
block content
    //#{devices}
    //#{devices._id.device_id}
    #header
        #logo
        #usermenu
            #username
        //=====LEFT MENU===============
    #tab
        ul(class='tabs')
            li(class='tab-link current close' data-tab='devices') Devices
                    i(class='icon-chevron-left')
            li(class='tab-link close' data-tab='users') Users
                i(class='icon-chevron-left')
            li(class='tab-link close' data-tab='filters') Filters
                i(class='icon-chevron-left')
            li(class='tab-link close' data-tab='settings') Settings
                i(class='icon-chevron-left')

    #conteiner
        //=======MAPS=============
        //#mapPanel(class="panel panel-default")
            div(class="panel-heading") Maps
            #maps(class="panel-body")
                script.
                    var map = L.map('maps').setView([55.7422, 37.5719], 1);
                    // add an OpenStreetMap tile layer
                    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
                    }).addTo(map);
                    // add a marker in the given location, attach some popup content to it and open the popup
                    var mark = L.marker([55.7422, 37.5719]);

        //===========TABS DEVICES=======================
        #devices(class='tab-content current')
            h2 Devices
            #filter
                form(class='form-search')
                    input(type="text" id="DeviceNameIDSerial" class='input-medium search-query input-xlarge' placeholder='Device name/ID/Serial' onkeyup="find()")
                    select(id='selectStatus' class="span2" onchange="find()")
                        option(value="" style='color:#cccccc') Select status
                        option(value='0') Offline
                        option(value='1') Online
                    select(id="selectCategory" class="span2" onchange="find()")
                    select(id="selectVersion" class="span2" onchange="find()")


            #add-device
                a(data-target="#addDevice" role="button" class="btn btn-primary" data-toggle="modal") add new device
                    //button(class='btn btn-primary')


            table(class='table table-hover table-bordered table-striped' id='paged')
                caption
                    h4
                thead(id='target')
                    tr
                        th(onclick='socket.emit("regularizeId",)') Device
                        th APK version
                        th Loader version
                        th Device status
                        th School
                        th Options
                        //th remove

                tbody(id='deviceTable')
            div(id='pagination' class='pagination pagination-centered')
            //============MODAL Add new device=====================
            div(class="modal" id="addDevice" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                div(class="modal-header")
                    button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                        i(class="icon-remove")
                    h3 Add new device
                div(class="modal-body")
                    textarea
                    form
                        p School
                        select(id="addSelectCategory")
                        br
                        p Version
                        select(id="addSelectVersion")
                        br
                        p Amount
                        input(id='amountDevice' type="number", name='number' min="1" value='1')
                div(class="modal-footer")
                    //button(class="btn btn-default" data-dismiss="modal" aria-hidden="true") Close
                    div(id='errorAddDevice' class='alert no-show')
                        //button(type="button" class="close" data-dismiss="alert") &times;
                        p All fields must be filled out
                    button(class="btn btn-primary" onclick='addDevice()') Add
            //============MODAL delete device=====================
            div(class="modal" id="deleteDevice" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                div(class="modal-header")
                    button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                        i(class="icon-remove")
                    h3 Delete device
                div(class="modal-body")

                div(class="modal-footer")
                    //button(class="btn btn-default" data-dismiss="modal" aria-hidden="true") Close
                    div(id='errorAddDevice' class='alert no-show')
                        //button(type="button" class="close" data-dismiss="alert") &times;
                        p All fields must be filled out
                    button(class="btn btn-primary" onclick='addDevice()') Add
            //============MODAL EDIT device=====================
            div(class="modal" id="editDevice" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                div(class="modal-header")
                    button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                        i(class="icon-remove")
                    h3 Edit device
                    div id
                        div(id='idDeviceModal')
                    div token
                        div(id='tokenDeviceModal')
                div(class="modal-body")
                    form
                        select(id="editDeviceCategory")
                        br
                        select(id="editDeviceVersion")
                        br
                        input(type='text' id="newNameUser" name='category' placeholder='Name User')
                        br
                        input(type='text' id="newComment" name='category' placeholder='Comments')
                div(class="modal-footer")
                    //button(class="btn btn-default" data-dismiss="modal" aria-hidden="true") Close
                    div(id='errorAddDevice' class='alert no-show')
                        //button(type="button" class="close" data-dismiss="alert") &times;
                        p All fields must be filled out
                    button(class="btn btn-primary" onclick='editDevice()') Edit
            //============MODAL maps=====================
            div(class="modal" id="map" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="z-index: -1; opacity: 0 ")
                div(class="modal-header")
                    button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                        i(class="icon-remove")
                    h3 Maps
                div(class="modal-body")
                    #maps(class="panel-body")
                        script.
                            var map = L.map('maps').setView([55.7422, 37.5719], 10);
                            // add an OpenStreetMap tile layer
                            L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                                attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
                            }).addTo(map);
                            // add a marker in the given location, attach some popup content to it and open the popup
                            var mark = L.marker([55.7422, 37.5719]);

            //===========Script maps========================
            script.
                function showmap(i, j) {
                    mark.addTo(map)
                    map.setView([i, j], 12);
                    mark.setLatLng(L.latLng(i, j)).update()
                    $('.map').css('z-index', '1050');
                }

            script(src="/js/socketTableData.js")
        //============TABS FILTERS========================
        #filters(class='tab-content')
            h2 Filters
            div(class='tabbable')
                ul(class='nav nav-tabs')
                    li(class='active')
                        a(href="#filtersSchool" data-toggle="tab") School
                    li
                        a(href='#filtersVersion' data-toggle="tab") Version
                #add-category
                    a(href='#createCategory' role="button" class="btn btn-primary" data-toggle="modal") add new category...
                    a(href='#addApkVersion' role="button" class="btn btn-primary" data-toggle="modal") add Apk version
                        //button(class='btn btn-primary') add new category...
                table(class='table table-hover table-bordered table-striped')
                    thead
                        tr
                            th(colspan='2') Category name
                    tbody(id='tableFilter')
                table(class='table table-hover table-bordered table-striped')
                    thead
                        tr
                            th version
                            th remove
                    tbody(id='versionTable')
            //============MODAL Create new category=====================
            div(class="modal" id="createCategory" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                div(class="modal-header")
                    button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                        i(class="icon-remove")
                    h3 Create new category
                div(class="modal-body")
                    form
                        div(class="input-append")
                            input(style='height: 34px' class="span3" size="16" id="newCategory" name='category')
                            button(class="btn btn-primary" onclick="createNewCategory()" type="button") Create
                            div(id='errorCreateCategory' class='alert no-show')
                                //button(type="button" class="close" data-dismiss="alert") &times;
                                p All fields must be filled out
                    //============MODAL Add new Apk version=====================
            div(class="modal" id="addApkVersion" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                div(class="modal-header")
                    button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                        i(class="icon-remove")
                    h3 Add new Apk version
                div(class="modal-body")
                    form(method="post" action='/uploadFile' enctype="multipart/form-data")
                        div(class="input-append")
                            input(type="file", name='category' value='')
                            button( type="submit" class="btn btn-primary") Add
                    //    hr
                    //    p Add new Apk version:
                    //form(method="post" action='/uploadFile' enctype="multipart/form-data")
                    //
                    //    input(type="file", name='category' value='')
                    //    button( type="submit" class="btn btn-primary") Add
            //============MODAL Edit category=====================
            div(class="modal" id="editCategory" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                div(class="modal-header")
                    button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                        i(class="icon-remove")
                    h3 Edit category
                div(class="modal-body")
                    form
                        input(type="input" id='newNameCategory')
                        button( type="button" onclick="inputNewNameCategory()") Edit
        //==========USERS TABS===================
        #users(class='tab-content')
            h2 Users
            #add-users
                a(href='#addUsers' role="button" class="btn btn-primary" data-toggle="modal") add new user
                    //button(class='btn btn-primary') add new user
            table(class='table table-hover table-bordered table-striped')
                thead
                    tr
                        th id
                        th name
                        th remove
                tbody(id='userTable')
            //============MODAL Add new user=====================
            div(class="modal" id="addUsers" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                div(class="modal-header")
                    button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                        i(class="icon-remove")
                    h3 Add new user
                div(class="modal-body")
                    form(class="form-horizontal" method='post' action="/signup")
                        div(class="control-group")
                            label(class="control-label") Name
                            div(class="controls")
                                input(style='height: 34px' class="span3" name='name' size="16" type="input" required)
                        div(class="control-group")
                            label(class="control-label") Password
                            div(class="controls")
                                input(style='height: 34px' class="span3" name='password' size="16" type="input" required)
                        div(class="controls")
                            button(class="btn btn-primary" type='submit') Add user
        //===========TABS SETTINGS================
        #settings(class='tab-content')
            h2 Settings
            div(class='calendar')
                script.
                    <div class="clndr-controls">
                        <div class="clndr-previous-button">&lsaquo;</div>
                        <div class="month"><%= month %></div>
                        <div class="clndr-next-button">&rsaquo;</div>
                    </div>
            //============MODAL EDIT device=====================

            div(class="modal" id="editSchedule" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
               div(class="modal-header")
                   button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                       i(class="icon-remove")
                   h3 Edit Schedule
                   div(class="modal-body")
                       div(id='dateSchedule')
                       input(type='time')
                       select(id="scheduleDeviceVersion")
                       hr
                       form
                           input(class="input-mini" type='text' id='idStart' placeholder='start id')
                           input(class="input-mini" type='text' id='idEnd' placeholder='end id')
                           select(id="scheduleDeviceCategory")
                           select(id="scheduleDeviceVersionFilter")
                       button(class="btn btn-primary" onclick='finsDeviceSchedule()') Find
                       hr
                       table(class='table table-hover table-bordered table-striped')
                           thead
                                tr
                                    th
                                        input(type='checkbox' onclick='checkAll(this)')
                                    th id
                                    th school
                                    th apk_version
                                    th update
                                    th status
                           tbody(id='tableSchedule')




