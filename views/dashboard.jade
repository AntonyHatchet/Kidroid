//
   Created by anton_gorshenin on 24.04.2015.
extends layout
block content
    //#{devices}
    //#{devices._id.device_id}
    //#header
    //    #logo
    //    #usermenu
    //        #username
    //    //=====LEFT MENU===============
    aside#tab
        ul(class='tabs')
            li(class='tab-link current close' data-tab='devices') Devices
                    i(class='icon-chevron-left')
            li(class='tab-link close' data-tab='users') Users
                i(class='icon-chevron-left')
            li(class='tab-link close' data-tab='filters') Filters
                i(class='icon-chevron-left')
            li(class='tab-link close' data-tab='settings') Settings
                i(class='icon-chevron-left')
            li(class='tab-link close')
            li(class='tab-link close' data-tab='requests') Requests
                i(class='icon-chevron-left')
            li(class='tab-link close' data-tab='planning') Planning
                i(class='icon-chevron-left')

    #conteiner
        //===========TABS DEVICES=======================
        #devices(class='tab-content current')
            h2 Devices
            fieldset
                legend Filter:
                #filter.col-sm-12
                    form(class='form-search form-inline col-sm-9')
                        input(type="text" id="DeviceNameIDSerial" class='form-control' placeholder='Device name/ID/Serial' onkeyup="find()")
                        select(id='selectStatus' class="span2 form-control" onchange="find()")
                            //option(value="" style='color:#cccccc') Select status
                            //option(value='0') Offline
                            //option(value='1') Online
                        select(id="selectCategory" class="span2 form-control" onchange="find()")
                        select(id="selectVersion" class="span2 form-control" onchange="find()")
                    #add-device
                        a(data-target="#addDevice" role="button" class="btn btn-primary" data-toggle="modal") Add New Device
            .col-sm-12
                h4.col-sm-6
                h5.col-sm-2.col-sm-offset-4
                    label(for="ItemsPerPage").col-sm-7.control-label Items per page:
                    .form-group.col-sm-5
                        select(id="ItemsPerPage")
                            option(value='0') 10
                            option(value='20') 20
                            option(value='50') 50
            .container-fluid.container-tab
                table(class='table table-hover table-bordered table-striped' id='paged')
                    thead(class='tableTarget')
                        tr
                            th
                                input(type="checkbox" id="checkboxWarning" value="option1")
                            th(onclick='find(sort(this))',data-sort="1",data-id="1") ID#
                                .glyphicon.glyphicon-sort
                            th(onclick='find(sort(this))',data-sort="1",data-id="2") Device Name
                                .glyphicon.glyphicon-sort
                            th(onclick='find(sort(this))',data-sort="1",data-id="3") APK version
                                .glyphicon.glyphicon-sort
                            th(onclick='find(sort(this))',data-sort="1",data-id="4") Loader version
                                .glyphicon.glyphicon-sort
                            th(onclick='find(sort(this))',data-sort="1",data-id="5") Device status
                                .glyphicon.glyphicon-sort
                            th Options
                    tbody(id='deviceTable')
            div(id='pagination' class="text-center")
            #deployApk
                fieldset
                    legend Marionette Deploy: (APK Deploy)
                    form(class='deployApk form-inline col-sm-12')
                        input.col-sm-1(type="checkbox" value="option")
                        label(for="addSelectCategory").col-sm-3.control-label Apply to all devices in the current query
                            span(id="deployCount")
                        .col-sm-8
                            .col-sm-3
                                select(id="selectVersionToDeploy" class="span2 form-control" onchange="find()")
                            button(class="col-sm-2 btn btn-primary" onclick='addDevice()') Start
            #deployKidroid
                fieldset
                    legend Kidroid Loader Deploy:
                    form(class='deployApk form-inline col-sm-12')
                        input.col-sm-1(type="checkbox" value="option")
                        label(for="addSelectCategory").col-sm-3.control-label Apply to all devices in the current query
                            span(id="deployCount")
                        .col-sm-8
                            .col-sm-3
                                select()
                            button(class="col-sm-2 btn btn-primary") Start
            //============MODAL Add new device=====================
            div(class="modal" id="addDevice" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                .modal-dialog.modal-sm
                    .modal-content
                        div(class="modal-header")
                            button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                                i(class="icon-remove")
                            h2 Add new device(s)
                        div(class="modal-body")
                            form.form-horizontal
                                .form-group
                                    label(for="addSelectCategory").col-sm-3.control-label School:
                                    .col-sm-9
                                        select(id="addSelectCategory" class="form-control")
                                .form-group
                                    label(for="addSelectVersion").col-sm-4.control-label APK version *:
                                    .col-sm-8
                                        select(id="addSelectVersion" class="form-control")
                                .form-group
                                    label(for="amountDevice").col-sm-5.control-label Device amount *:
                                    .col-sm-7
                                        input(id='amountDevice' type="number", name='number' min="1" value='1' class="form-control")
                                .form-group
                                    label(for="commentDevice").col-sm-5.control-label Comment:
                                    .col-sm-12.margin-top-5
                                        textarea(id='commentDevice' class="form-control" rows="3")
                        div(class="modal-footer")
                            //button(class="btn btn-default" data-dismiss="modal" aria-hidden="true") Close
                            div(id='errorAddDevice' class='alert no-show')
                                //button(type="button" class="close" data-dismiss="alert") &times;
                                p All fields must be filled out
                            button(class="btn btn-primary" onclick='addDevice()') Add

            //============MODAL delete device=====================
            div(class="modal" id="deleteDevice" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                .modal-dialog
                    .modal-content
                        div(class="modal-header")
                            button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                                i(class="icon-remove")
                            h3 Delete device
                        div(class="modal-body")

                        div(class="modal-footer")
                            //button(class="btn btn-default" data-dismiss="modal" aria-hidden="true") Close
                            div(id='errorAddDevice' class='alert no-show')
                                //button(type="button" class="close" data-dismiss="alert") &times;
                                p All fields must be filled out
                            button(class="btn btn-primary" onclick='addDevice()') Add
            //============MODAL EDIT device=====================
            div(class="modal" id="editDevice" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                .modal-dialog.modal-sm
                    .modal-content
                        div(class="modal-header")
                            button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                                i(class="icon-remove")
                            h3 Edit device
                        div(class="modal-body")
                            form.form-horizontal
                                .form-group
                                    label(for="editDeviceCategory").col-sm-3.control-label School:
                                    .col-sm-9
                                        select(id="editDeviceCategory" class="form-control")
                                .form-group
                                    label(for="addSelectVersion").col-sm-4.control-label APK version *:
                                    .col-sm-8
                                        select(id="editDeviceVersion" class="form-control")
                                .form-group
                                    label(for="newNameUser").col-sm-5.control-label Name:
                                    .col-sm-12.margin-top-5
                                        input(type='text' id="newNameUser" name='category' placeholder='Name User' class="form-control")
                                .form-group
                                    label(for="newComment").col-sm-5.control-label Comment:
                                    .col-sm-12.margin-top-5
                                        input(type='text' id="newComment" name='category' placeholder='Comments' class="form-control")
                        div(class="modal-footer")
                            //button(class="btn btn-default" data-dismiss="modal" aria-hidden="true") Close
                            div(id='errorAddDevice' class='alert no-show')
                                //button(type="button" class="close" data-dismiss="alert") &times;
                                p All fields must be filled out
                            button(class="btn btn-primary" onclick='editDevice()') Edit
            //============MODAL maps=====================
            div(class="modal" id="map" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="z-index: -1; opacity: 0 ")
                .modal-dialog.modal-lg
                    .modal-content
                        div(class="modal-header")
                            button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                                i(class="icon-remove")
                            h3 Maps
                        div(class="modal-body")
                            #maps(class="panel-body")
                                script.
                                    var map = L.map('maps').setView([55.7422, 37.5719], 10);
                                    // add an OpenStreetMap tile layer
                                    L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                                        attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
                                    }).addTo(map);
                                    // add a marker in the given location, attach some popup content to it and open the popup
                                    var mark = L.marker([55.7422, 37.5719]);

            //===========Script maps========================
            script.
                function showmap(i, j) {
                    mark.addTo(map)
                    map.setView([i, j], 12);
                    mark.setLatLng(L.latLng(i, j)).update()
                    $('.map').css('z-index', '1050');
                    if(i==0||j==0){
                        $('#buttonMap').addClass('no-show');
                    }
                }

            script(src="/js/socketTableData.js")
        //============TABS FILTERS========================
        #filters(class='tab-content')
            h2 Filters
            div(class='tabbable')
                .col-sm-12
                    ul(class='nav-tabs')
                        li(class='tab-link current close' data-tab="filtersSchool") School
                        li(class='tab-link close' data-tab='filtersVersion') Version
                #filtersSchool(class='nav-tab-content current')
                    #add-category
                        a(href='#createCategory' role="button" class="btn btn-primary" data-toggle="modal") Add new category...
                            //button(class='btn btn-primary') add new category...
                    .col-sm-12
                        table(class='table table-hover table-bordered table-striped')
                            thead
                                tr
                                    th(colspan='2') Category name
                            tbody(id='tableFilter')

            //============MODAL Create new category=====================
            div(class="modal" id="createCategory" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                .modal-dialog.modal-sm
                    .modal-content
                        div(class="modal-header")
                            button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                                i(class="icon-remove")
                            h3 Create new category
                        div(class="modal-body")
                            form
                                .form-group
                                input(class="form-control" id="newCategory" name='category')
                        div(class="modal-footer")
                            div(id='errorCreateCategory' class='alert no-show')
                                p All fields must be filled out
                            button(class="btn btn-primary" onclick="createNewCategory()" type="button") Create

            //============MODAL Edit category=====================
            div(class="modal" id="editCategory" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                .modal-dialog.modal-sm
                    .modal-content
                        div(class="modal-header")
                            button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                                i(class="icon-remove")
                            h3 Edit category
                        div(class="modal-body")
                            form
                                .form-group
                                input(type="input" class="form-control" id='newNameCategory')
                        div(class="modal-footer")
                            button( type="button" class="btn btn-primary" onclick="inputNewNameCategory()") Edit
        //==========USERS TABS===================
        #users(class='tab-content')
            h2 Users
            #add-users
                a(href='#addUsers' role="button" class="btn btn-primary" data-toggle="modal") add new user
                    //button(class='btn btn-primary') add new user
            table(class='table table-hover table-bordered table-striped')
                thead
                    tr
                        th(onclick='sort(this)',data-value="0")
                            input(type='checkbox' id='checkAllSchedule')
                        th id
                        th name
                        th remove
                tbody(id='userTable')
            //============MODAL Add new user=====================
            div(class="modal" id="addUsers" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                .modal-dialog.modal-sm
                    .modal-content
                        div(class="modal-header")
                            button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                                i(class="icon-remove")
                            h3 Add new user
                        div(class="modal-body")
                            form(class="form-horizontal" method='post' action="/signup")
                                .form-group
                                input(name='name' class="form-control" type='text' placeholder='name' required)
                                .form-group
                                input(name='password' class="form-control" type='text' placeholder='password' required)
                        div(class="modal-footer")
                            button(class="btn btn-primary" type='submit') Add user
        //===========TABS requests================
        #requests(class='tab-content')
            fieldset
                legend Marionette APK
                div(class='form-search form-inline col-sm-9')
                    label(for='selectVersion') Current version:
                    select(id="selectVersion" class="form-control" onchange="find()")

                .col-sm-12
                    table(class='table table-hover table-bordered table-striped')
                        thead
                            tr
                                th version
                                th build
                                th remove
                        tbody(id='versionTable')
                a(href='#addApkVersion' role="button" class="btn btn-primary" data-toggle="modal") add Apk version
                    //============MODAL Add new Apk version=====================
            div(class="modal" id="addApkVersion" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                .modal-dialog.modal-sm
                    .modal-content
                        div(class="modal-header")
                            button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                                i(class="icon-remove")
                            h3 Add new Apk version
                        div(class="modal-body")
                            form(method="post" action='/uploadFile' enctype="multipart/form-data")
                                .form-group
                                input(type="file", class="form-control" name='category' value='')
                        div(class="modal-footer")
                            button( type="submit" class="btn btn-primary") Add
        //===========TABS planning================
        #planning(class='tab-content')
            h2 Planning
            div(class='calendar')
                script.
                    <div class="clndr-controls">
                        <div class="clndr-previous-button">&lsaquo;</div>
                        <div class="month"><%= month %></div>
                        <div class="clndr-next-button">&rsaquo;</div>
                    </div>
            //#allSchedule
            //============MODAL EDIT Schedule=====================
            div(class="modal" id="editSchedule" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;")
                .modal-dialog.modal-sm
                    .modal-content
                        div(class="modal-header")
                            button(type="button" class="close" data-dismiss="modal" aria-hidden="true")
                                i(class="icon-remove")
                            h3 Edit Schedule
                        div(class="modal-body")
                            form
                                .form-group
                                div(id='dateSchedule')
                                input(class="form-control" id='timeSchedule' type='time' required)
                                .form-group
                                select(class="form-control" id="scheduleDeviceVersion" required)
                                hr
                                form
                                    .form-group
                                    input(class="form-control" type='text' id='idStart' placeholder='start id')
                                    input(class="form-control" type='text' id='idEnd' placeholder='end id')
                                    .form-group
                                    input(class="form-control" id="autocomplete-dynamic")
                                    select(class="form-control" id="scheduleDeviceVersionFilter")
                                button(class="btn btn-primary" onclick='finsDeviceSchedule()') Find
                                hr
                                #tableScheduleFind
                                    table(class='table table-hover table-bordered table-striped')
                                        thead
                                            tr
                                                th(onclick='sort(this)',data-value="0")
                                                    input(type='checkbox' id='checkAllSchedule')
                                                th id
                                                th school
                                                th apk_version
                                                th update
                                                th status
                                        tbody(id='tableSchedule')

                        div(class="modal-footer")
                            #errorAddSchedule(class='no-show') error
                            button(id="closeScheduleModal" class="btn btn-danger") Close
                            button(onclick="createSchedule()" class="btn btn-primary") Create

        //===========TABS planning================
       #requests(class='tab-content')
           h2 Requests
           #allSchedule

